<div class="container-fluid mt-4">
  <!-- Collection Details -->
  <div class="row p-3">
    <div class="col-md-5">
      <img
         [src]="collection?.imageUrl || 'assets/logo.png'"
         [alt]="collection?.topic"
         class="img-fluid rounded shadow"
         style="max-height: 400px; object-fit: cover;"
         onerror="this.src='assets/logo.png'"
      >
    </div>
    <div class="col-md-7">
      <div class="d-flex justify-content-between align-items-start">
        <div>
          <h2 class="mb-1">{{collection?.name}}</h2>
          <p class="text-muted small mb-3">{{collection?.topic}}</p>
        </div>
      </div>
      <p class="mb-3">{{collection?.description}}</p>
      <p class="mb-1"><strong>Items quantity:</strong> {{collection?.itemCount}}</p>
      <p class="mb-1">
        <strong>Created by</strong>
         
         <a href="" [routerLink]="['/profile-view', collection?.userId]"class="text-decoration-none">
          {{collection?.userName}}
        </a> 
      </p>
      <div class="d-flex mt-4" *ngIf="isLoggedIn && collection?.userId === currentUser || isAdmin">
        <button
        class="btn btn-sm btn-outline-success me-2"
        (click)="addNewItem(collection?.id)"
     >
       Add New Item
     </button>
        <button
           class="btn btn-sm btn-outline-primary me-2"
           (click)="editCollection(collection?.id)"
        >
          Edit
        </button>
        <button
           class="btn btn-sm btn-outline-danger"
           (click)="deleteCollection(collection?.id)"
        >
          Delete
        </button>
      </div>
    </div>
  </div>

  <!-- Items Table -->
  <div class="row mt-5">
    <div class="col-12">
      <h3>Items in Collection</h3>
      <div class="table-container">
        <table class="table table-striped table-nowrap">
          <thead>
            <tr>
              <th>#</th>
              <th>IMAGE</th>
              <th>NAME</th>
              <th>CREATED AT</th>
              <th>LIKES</th>
              <th *ngIf="isLoggedIn && collection?.userId === currentUser || isAdmin">ACTIONS</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of items; let i = index" (click)="navigateToDetail(item.id)" style="cursor: pointer;">
              <td>{{ i + 1 }}</td>
              <td>
                <img
                   [src]="item.imgUrl || 'assets/logo.png'"
                   [alt]="item.name"
                   class="img-thumbnail"
                   style="width: 80px; height: 80px; object-fit: cover;"
                   onerror="this.src='assets/logo.png'"
                >
              </td>
              <td>{{ item.name }}</td>
              <td>{{ item.dateAdded | date }}</td>
              <td>{{ item.likes }}</td>
              <td *ngIf="isLoggedIn && collection?.userId === currentUser || isAdmin" (click)="$event.stopPropagation()">
                <div class="dropdown" ngbDropdown>
                  <button class="btn btn-outline-secondary" ngbDropdownToggle>
                    Actions
                  </button>
                  <div class="dropdown-menu" ngbDropdownMenu>
                    <button class="dropdown-item" (click)="handleAction($event, 'edit', item)">Edit</button>
                    <button class="dropdown-item" (click)="handleAction($event, 'delete', item)">Delete</button>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>